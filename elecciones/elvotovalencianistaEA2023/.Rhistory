rutaFicheros<-"/home/tomas/Documents/CPyGP/2 CURSO 2023-2024/R&3415"
nombreFichero<-"3415.sav"
rutaFichero <- paste(rutaFicheros, nombreFichero, sep = "/")
df_cisjulio<-haven::read_sav(rutaFichero)
rutaFicheros<-"/home/tomas/Documents/CPyGP/2 CURSO 2023-2024/R/3415"
nombreFichero<-"3415.sav"
rutaFichero <- paste(rutaFicheros, nombreFichero, sep = "/")
df_cisjulio<-haven::read_sav(rutaFichero)
unique(df_cisjulio$PREFPTE)
df_cis<-df_cisjulio [, "PREFPTE"]
tail(df_cis,4)
dim(df_cis)
dim(df_cisjulio)
ncasos<-nrow(df_cis)
ncasos1<-nrow(df_cisjulio)
nvars<-ncol(df_cisjulio)
df_cis$recPREFPTE<-df_cis$PREFPTE
df_cis$recPREFPTE[df_cis$recPREFPTE >=96]<-NA
df_cis$recPREFPTE<-factor(df_cis$recPREFPTE,
levels=c(1,2,3,4,5,6,7),
labels=c("Pedro Sánchez", "Alberto Núñez Feijóo",
"Santiago Abascal","Yolanda Díaz","Ione Belarra",
"Íñigo Errejón","Isabel Díaz Ayuso"))
summary(df_cis$recPREFPTE, na.rm=FALSE)
numero_na<-sum(is.na(df_cis$recPREFPTE))
porcentaje_na<-round(mean(is.na(df_cis$recPREFPTE))*100,1)
moda <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
varModa<-moda(df_cis$recPREFPTE)
table(df_cis$recPREFPTE, useNA="no")
round(prop.table(table(df_cis$recPREFPTE))*100,digits=1)
require(epiDisplay)
grafico <- tab1(df_cis$recPREFPTE,cum.percent = TRUE,sort.group="decreasing",
xlab="% preferencia",decimal=1,bar.values = "percent",
main="Gráfico 1. Preferencia para Presidencia de Gobierno",
missing=FALSE,
col=c("#c8e6c9","#FF33FF","#1976d2","#2ecc71","#ab47bc","#2980b9","red"))
valores<-as.numeric(round(prop.table(table(df_cis$recPREFPTE))*100,digits=1))
nombres<-names(round(prop.table(table(df_cis$recPREFPTE))*100,digits=1))
#vector con los índices ordenados según valor decreciente
orden<-order(valores,decreasing=TRUE)
valoresOrdenados<-valores[orden]
nombresOrdenados<-nombres[orden]
colores=c("red","#1976d2","#FF33FF","#2ecc71","#2980b9","#ab47bc","#c8e6c9")
pie(valores, labels = nombres, main = "Gráfico 2. Preferencia para Presidencia de Gobierno",col = colores, cex=0.8)
valores<-as.numeric(round(prop.table(table(df_cis$recPREFPTE))*100,digits=1))
nombres<-names(round(prop.table(table(df_cis$recPREFPTE))*100,digits=1))
#vector con los índices ordenados según valor decreciente
orden<-order(valores,decreasing=TRUE)
valoresOrdenados<-valores[orden]
nombresOrdenados<-nombres[orden]
colores=c("red","#1976d2","#FF33FF","#2ecc71","#2980b9","#ab47bc","#c8e6c9")
# Calcular el porcentaje acumulado
porcentajeAcumulado<-cumsum(valoresOrdenados/sum(as.numeric(valoresOrdenados)))*100
# Crear el gráfico de Pareto
par(mar = c(1, 2, 10, 2))  # Ajustar los márgenes del gráfico
ylim <- range(c(valoresOrdenados, porcentajeAcumulado))
ylim[2] <- ylim[2] + 10  # Ajustar el límite superior para dejar espacio adicional
barplot(valoresOrdenados, main = "Gráfico 3. Preferencia Presidencia de Gobierno.", xlab = "Candidatos", ylab = "Frecuencia", col = "blue")
lines(porcentajeAcumulado, type = "b", col = "red", pch = 21, bg = "red", yaxt = "n")
#axis(4, at = seq(0, 100, by = 10), labels = paste0(seq(0, 100, by = 10), "%"), col = "red", las = 1)
legend("topright", legend = c("Frecuencia", "Porcentaje acumulado"), col = c("blue", "red"), lty = 1, pch = c(NA, 21), pt.bg = c(NA, "red"))
# grafico$output.table # Esta dentro de los atributos, es un exportable que se genera
df_tabla<-grafico$output.table
colnames(df_tabla)<-c("Frecuencia","%","%_acumulado", "%_válido","%_acumulado válido")
knitr::kable(df_tabla,column.width=c("10%","20%","20%","20%","20%"))
# Guardamos la tabla de frecuencias en un fichero csv
write.csv(grafico, file = "tablafrec.csv", row.names = TRUE)
install.packages("xlsx")
require(xlsx)
write.xlsx(grafico, file = "resultados.xlsx",               # file= nombre del fichero
sheetName = "prefpte", append = FALSE)           # file= nombre de la página
colnames(df_cis)
colnames(df_cisjulio$ESTUDIO)
colnames(df_cisjulio$REGISTRO)
df_cisjulio$REGISTRO
df_cisjulio$PROBVOTO
rutaFicheros<-"/home/tomas/Documents/CPyGP/2 CURSO 2023-2024/R"
nombreFichero<-"cisjulio2022.sav"
rutaFichero <- paste(rutaFicheros, nombreFichero, sep = "/")
df_cisjulio<-haven::read_sav(rutaFichero)
unique(df_cisjulio$PREFPTE)
df_cis<-df_cisjulio [, "PREFPTE"]
tail(df_cis,4)
dim(df_cis)
dim(df_cisjulio)
ncasos<-nrow(df_cis)
ncasos1<-nrow(df_cisjulio)
nvars<-ncol(df_cisjulio)
df_cis$recPREFPTE<-df_cis$PREFPTE
df_cis$recPREFPTE[df_cis$recPREFPTE >=96]<-NA
df_cis$recPREFPTE<-factor(df_cis$recPREFPTE,
levels=c(1,2,3,4,5,6,7),
labels=c("Pedro Sánchez", "Alberto Núñez Feijóo",
"Santiago Abascal","Yolanda Díaz","Ione Belarra",
"Íñigo Errejón","Isabel Díaz Ayuso"))
summary(df_cis$recPREFPTE, na.rm=FALSE)
numero_na<-sum(is.na(df_cis$recPREFPTE))
porcentaje_na<-round(mean(is.na(df_cis$recPREFPTE))*100,1)
moda <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
varModa<-moda(df_cis$recPREFPTE)
table(df_cis$recPREFPTE, useNA="no")
round(prop.table(table(df_cis$recPREFPTE))*100,digits=1)
require(epiDisplay)
grafico <- tab1(df_cis$recPREFPTE,cum.percent = TRUE,sort.group="decreasing",
xlab="% preferencia",decimal=1,bar.values = "percent",
main="Gráfico 1. Preferencia para Presidencia de Gobierno",
missing=FALSE,
col=c("#c8e6c9","#FF33FF","#1976d2","#2ecc71","#ab47bc","#2980b9","red"))
valores<-as.numeric(round(prop.table(table(df_cis$recPREFPTE))*100,digits=1))
nombres<-names(round(prop.table(table(df_cis$recPREFPTE))*100,digits=1))
#vector con los índices ordenados según valor decreciente
orden<-order(valores,decreasing=TRUE)
valoresOrdenados<-valores[orden]
nombresOrdenados<-nombres[orden]
colores=c("red","#1976d2","#FF33FF","#2ecc71","#2980b9","#ab47bc","#c8e6c9")
pie(valores, labels = nombres, main = "Gráfico 2. Preferencia para Presidencia de Gobierno",col = colores, cex=0.8)
valores<-as.numeric(round(prop.table(table(df_cis$recPREFPTE))*100,digits=1))
nombres<-names(round(prop.table(table(df_cis$recPREFPTE))*100,digits=1))
#vector con los índices ordenados según valor decreciente
orden<-order(valores,decreasing=TRUE)
valoresOrdenados<-valores[orden]
nombresOrdenados<-nombres[orden]
colores=c("red","#1976d2","#FF33FF","#2ecc71","#2980b9","#ab47bc","#c8e6c9")
# Calcular el porcentaje acumulado
porcentajeAcumulado<-cumsum(valoresOrdenados/sum(as.numeric(valoresOrdenados)))*100
# Crear el gráfico de Pareto
par(mar = c(1, 2, 10, 2))  # Ajustar los márgenes del gráfico
ylim <- range(c(valoresOrdenados, porcentajeAcumulado))
ylim[2] <- ylim[2] + 10  # Ajustar el límite superior para dejar espacio adicional
barplot(valoresOrdenados, main = "Gráfico 3. Preferencia Presidencia de Gobierno.", xlab = "Candidatos", ylab = "Frecuencia", col = "blue")
lines(porcentajeAcumulado, type = "b", col = "red", pch = 21, bg = "red", yaxt = "n")
#axis(4, at = seq(0, 100, by = 10), labels = paste0(seq(0, 100, by = 10), "%"), col = "red", las = 1)
legend("topright", legend = c("Frecuencia", "Porcentaje acumulado"), col = c("blue", "red"), lty = 1, pch = c(NA, 21), pt.bg = c(NA, "red"))
# grafico$output.table # Esta dentro de los atributos, es un exportable que se genera
df_tabla<-grafico$output.table
colnames(df_tabla)<-c("Frecuencia","%","%_acumulado", "%_válido","%_acumulado válido")
knitr::kable(df_tabla,column.width=c("10%","20%","20%","20%","20%"))
# Guardamos la tabla de frecuencias en un fichero csv
write.csv(grafico, file = "tablafrec.csv", row.names = TRUE)
install.packages("xlsx")
require(xlsx)
write.xlsx(grafico, file = "resultados.xlsx",               # file= nombre del fichero
sheetName = "prefpte", append = FALSE)           # file= nombre de la página
install.packages("xlsx")
knit_with_parameters("~/Documents/CPyGP/2 CURSO 2023-2024/R/CisJulio.rmd")
rutaFicheros<-"/home/tomas/Documents/CPyGP/2 CURSO 2023-2024/R/3415"
nombreFichero<-"datosjulio2023.sav"
rutaFichero <- paste(rutaFicheros, nombreFichero, sep = "/")
df_cisjulio<-haven::read_sav(rutaFichero)
unique(df_cisjulio$PREFPTE)
df_cis<-df_cisjulio [, "PREFPTE"]
tail(df_cis,4)
dim(df_cis)
dim(df_cisjulio)
ncasos<-nrow(df_cis)
ncasos1<-nrow(df_cisjulio)
nvars<-ncol(df_cisjulio)
df_cis$recPREFPTE<-df_cis$PREFPTE
df_cis$recPREFPTE[df_cis$recPREFPTE >=96]<-NA
df_cis$recPREFPTE<-factor(df_cis$recPREFPTE,
levels=c(1,2,3,4,5,6,7),
labels=c("Pedro Sánchez", "Alberto Núñez Feijóo",
"Santiago Abascal","Yolanda Díaz","Ione Belarra",
"Íñigo Errejón","Isabel Díaz Ayuso"))
summary(df_cis$recPREFPTE, na.rm=FALSE)
numero_na<-sum(is.na(df_cis$recPREFPTE))
porcentaje_na<-round(mean(is.na(df_cis$recPREFPTE))*100,1)
moda <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
varModa<-moda(df_cis$recPREFPTE)
table(df_cis$recPREFPTE, useNA="no")
round(prop.table(table(df_cis$recPREFPTE))*100,digits=1)
require(epiDisplay)
grafico <- tab1(df_cis$recPREFPTE,cum.percent = TRUE,sort.group="decreasing",
xlab="% preferencia",decimal=1,bar.values = "percent",
main="Gráfico 1. Preferencia para Presidencia de Gobierno",
missing=FALSE,
col=c("#c8e6c9","#FF33FF","#1976d2","#2ecc71","#ab47bc","#2980b9","red"))
valores<-as.numeric(round(prop.table(table(df_cis$recPREFPTE))*100,digits=1))
nombres<-names(round(prop.table(table(df_cis$recPREFPTE))*100,digits=1))
#vector con los índices ordenados según valor decreciente
orden<-order(valores,decreasing=TRUE)
valoresOrdenados<-valores[orden]
nombresOrdenados<-nombres[orden]
colores=c("red","#1976d2","#FF33FF","#2ecc71","#2980b9","#ab47bc","#c8e6c9")
pie(valores, labels = nombres, main = "Gráfico 2. Preferencia para Presidencia de Gobierno",col = colores, cex=0.8)
valores<-as.numeric(round(prop.table(table(df_cis$recPREFPTE))*100,digits=1))
nombres<-names(round(prop.table(table(df_cis$recPREFPTE))*100,digits=1))
#vector con los índices ordenados según valor decreciente
orden<-order(valores,decreasing=TRUE)
valoresOrdenados<-valores[orden]
nombresOrdenados<-nombres[orden]
colores=c("red","#1976d2","#FF33FF","#2ecc71","#2980b9","#ab47bc","#c8e6c9")
# Calcular el porcentaje acumulado
porcentajeAcumulado<-cumsum(valoresOrdenados/sum(as.numeric(valoresOrdenados)))*100
# Crear el gráfico de Pareto
par(mar = c(1, 2, 10, 2))  # Ajustar los márgenes del gráfico
ylim <- range(c(valoresOrdenados, porcentajeAcumulado))
ylim[2] <- ylim[2] + 10  # Ajustar el límite superior para dejar espacio adicional
barplot(valoresOrdenados, main = "Gráfico 3. Preferencia Presidencia de Gobierno.", xlab = "Candidatos", ylab = "Frecuencia", col = "blue")
lines(porcentajeAcumulado, type = "b", col = "red", pch = 21, bg = "red", yaxt = "n")
#axis(4, at = seq(0, 100, by = 10), labels = paste0(seq(0, 100, by = 10), "%"), col = "red", las = 1)
legend("topright", legend = c("Frecuencia", "Porcentaje acumulado"), col = c("blue", "red"), lty = 1, pch = c(NA, 21), pt.bg = c(NA, "red"))
# grafico$output.table # Esta dentro de los atributos, es un exportable que se genera
df_tabla<-grafico$output.table
colnames(df_tabla)<-c("Frecuencia","%","%_acumulado", "%_válido","%_acumulado válido")
knitr::kable(df_tabla,column.width=c("10%","20%","20%","20%","20%"))
# Guardamos la tabla de frecuencias en un fichero csv
write.csv(grafico, file = "tablafrec.csv", row.names = TRUE)
install.packages("xlsx")
require(xlsx)
write.xlsx(grafico, file = "resultados.xlsx",               # file= nombre del fichero
sheetName = "prefpte", append = FALSE)           # file= nombre de la página
